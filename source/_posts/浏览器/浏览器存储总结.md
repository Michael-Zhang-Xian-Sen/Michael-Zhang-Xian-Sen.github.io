---
title: 浏览器存储总结 #文章页面上的显示名称，可以任意修改，不会出现在URL中
date: 2020-08-17 15:04:50 #文章生成时间，一般不改，当然也可以任意修改
categories: 前端 #分类
tags: [浏览器原理] #文章标签，可空，多标签请用格式，注意:后面有个空格
---

存储方式：
1. localStorage
2. sessionStorage
3. cookie

浏览器的存储根据上下文环境不同，涉及到几个层级关系。
1. 浏览器。firefox or chome or ...
2. 浏览器窗口。一个窗口包含一堆标签页。
3. 浏览器标签页。
    * 引申：标签页之间是否同源。
    * 引申：点击链接，进行跳转
        * 跳转到新的标签页。
        * 在本标签页内跳转，不生成新页面。
4. 内嵌iframe

## 1. localStorage
HTML5新增。可以长期存储,只要你不清理数据就会长期存在，所以主要是存储长期的数据。
* 生命周期：用于将数据长久保存在网站中，保存的数据没有过期时间，直到手动删除。
* 使用范围：同一个浏览器下的不同浏览器窗口的同源标签页之间，可以共享。
* 大小：因浏览器而异，大致在2.5MB到10MB之间。

### 基本操作
`localStorage`对象的对象原型为`Storage`。
* 设置localStorage：`localStorage.setItem('test','设置localStorage')`
* 获取localStorage
    * 获取指定记录：`localStorage.getItem('test')`
    * 获取全部记录：`window.localStorage`
* 移除localStorage
    * 移除指定记录：`localStorage.removeItem('test')`
    * 移除全部记录：`localStorage.clear()`
* 获取localStorage的长度：`localStorage.length`
* 获取某条localStorage记录的名称：`localStorage.key(idx)`

## 2. sessionStorage
HTML5新增。主要用来保存当前会话的数据。
* 生命周期：当前窗口/标签页，刷新时不会被清空。
* 使用范围：当前标签页。当前标签页内跳转可以共享sessionStorage，但是通过打开新标签页跳转时不能共享。

### 基本操作
`sessionStorage`的对象原型也为`Storage`。api和localStorage几乎可以说是一模一样。
* 设置sessionStorage：`sessionStorage.setItem('test',"设置sessionStorage)`
* 获取sessionStorage
    * 获取指定记录：`sessionStorage.getItem('test')`
    * 获取全部记录：`window.sessionStorage`
* 移除sessionStorage
    * 移除指定记录：`sessionStorage.removeItem('test')`
    * 移除全部记录：`sessionStorage.clear()`
* 获取sessionStorage的长度：`sessionStorage.length`
* 获取某条sessionStorage记录的名称：`sessionStorage.key(idx)`

## 3. cookie
cookie经常与session搭配使用。由于http协议是无状态的，而服务器如果要识别当前通信的客户，此时需要一个“通行证”，由服务器颁发给客户端，客户端以后再与后台通信时，仅需要将通行证和要传递的内容一起发给后台，后台看到通行证就会明白自己在与谁通信，然后就可以将需要的数据返回给前端。cookie和session的作用，就是此处的通行证。

生命周期：Cookie存储于电脑上的文本文件中，如果不进行清除或未打到过期时间，永远不会消失。
适用范围：同一个浏览器下可以共享。
使用场景：可以帮助我们实现记录用户个人信息的功能。Cookie经常被用于存储用户的信息，来实现记住用户名、记住密码等功能。

### 基本操作
* 设置cookie：`document.cookie="键值对;过期时间;cookie路径"`，如：`document.cookie="username=John Doe; expires=Thu, 18 Dec 2043 12:00:00 GMT; path=/";`
* 获取cookie：获取字符串格式的cookie：`document.cookie`
* 删除cookie：为该记录设置一个已经过去的时间或者当前时间`document.cookie = "username=; expires=Thu, 01 Jan 1970 00:00:00 GMT";`
由于cookie的相关api较少，操作不方便，故使用时最好能够封装一些cookie的基本操作。

## 4. indexedDB
浏览器内置的大量数据存储技术。

相关教程：http://www.ruanyifeng.com/blog/2018/07/indexeddb.html


## localStorage和sessionStorage的区别
时效性。localStorage会一直存储在浏览器中，除非手动删除。而sessionStorage会在关闭窗口或标签页后清除，仅仅用于临时保存。